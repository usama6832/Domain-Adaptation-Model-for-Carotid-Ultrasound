# GAN-Based Ultrasound Image Domain Adaptation

# Overview
This repository contains the code and resources for our paper, "**A Domain Adaptation Model for Carotid Ultrasound: Image Harmonization, Noise Reduction, and Impact on Cardiovascular Risk Markers**," where we address domain adaptation challenges in carotid ultrasound imaging. Our approach utilizes a Generative Adversarial Network (GAN) to harmonize and denoise Carotid ultrasound images while preserving anatomical structures.

# Abstract
Deep learning has been used extensively for medical image analysis applications, assuming the training and test data adhere to the same probability distributions. However, a common challenge arises when dealing with medical images generated by different systems or even the same system with varying parameter settings. Such images often contain diverse textures and noise patterns, violating the assumption. Consequently, models trained on data from one machine or setting usually struggle to perform effectively on data from another. To address this issue in ultrasound images, we proposed a Generative Adversarial Network (GAN) based model in this paper. We formulated image harmonization and denoising tasks as an image-to-image translation task, wherein we adapt the texture pattern and reduced noise in Carotid ultrasound images while keeping the image content (the anatomy) unchanged. 
The performance was evaluated using feature distribution and pixel-space similarity metrics. In addition, blood-to-tissue contrast and influence on computed risk markers (Gray scale median, GSM) were evaluated.
The results showed that domain adaptation was achieved in both tasks (histogram correlation 0.920 and 0.844), as compared to no adaptation (0.890 and 0.707), and that the anatomy of the images was retained (structure similarity index measure e.g. the arterial wall 0.71 and 0.80). In addition, the image noise level (contrast) did not change in the image harmonization task (-34.1 vs 35.2 dB) but was improved in the noise reduction task (-23.5 vs -46.7 dB). 
The model outperformed the CycleGAN in both tasks. Finally, the risk marker GSM was significantly changed in the noise reduction but not in the image harmonization task.
We conclude that domain translation models are powerful tools for ultrasound image improvement while retaining the underlying anatomy, but downstream calculations of risk markers may be affected.

# Key Features
**Image Harmonization:** Aligns texture patterns across different ultrasound systems.  
**Noise Reduction:** Reduces noise while preserving critical anatomical structures.  
**Domain Adaptation:** Achieves higher histogram correlation than CycleGAN.  
**Anatomy Preservation:** High SSIM scores ensuring structural integrity.  
**Risk Marker Analysis:** Evaluates changes in computed GSM values.

# Repository Structure
├── data/                    # Sample input/output ultrasound images  
├── models/                  # GAN architecture and pretrained models  
├── scripts/                 # Training and evaluation scripts  
├── results/                 # Evaluation metrics and visualization  
├── README.md                # This file  
└── requirements.txt         # Dependencies  

# Installation

**Clone this repository:**  
git clone <repository_url>  
cd <repository_name>  

**Install dependencies:**  
pip install -r requirements.txt  

# Training

**Run the training script:**  
python main.py --train  

# Evaluation

**Evaluate the trained model:**  
python main.py --test  


# Citation  
If you make use of the code, please cite the paper in resulting publication as:  

@article{usama2024gan,  
  title={A Domain Adaptation Model for Carotid Ultrasound: Image Harmonization, Noise Reduction, and Impact on Cardiovascular Risk Markers},  
  author={Usama, M., Nyman, E., Naslund, U., & Gronlund, C.},  
  journal={arXiv preprint arXiv:2407.05163.},  
  year={2024}  
}

# License
This project is licensed under the MIT License.

# Contact
For questions, contact Usama at: <a href="mailto:mohd.usama@umu.se.com">mohd.usama@umu.se</a>, Christer at: <a href="mailto:christer.gronlund@umu.se">christer.gronlund@umu.se</a>






